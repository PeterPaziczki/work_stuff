---
title: "Field_test_eval"
author: "Peter Paziczki"
date: "September 19, 2018"
output: html_document
---

<style>
body {
text-align: justify}
</style>

```{r setup, include=FALSE}
rm(list=ls())
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, echo = FALSE)
```

```{r echo=FALSE}
# Loading necessary libraries
library(ggplot2)
library(data.table)

# Loading the data
data_source <- fread(file = "field_test_db_2018_6_1-2018_9_19.csv" , stringsAsFactors = F )
# Making a copy so the source cannot ne modified
my_data <- data_source
# Uninteded disengagements only
unintended_disengs <- my_data[Intended == 'FALSE']
```

```{r}
# Some statistics
#plot(density(my_data$Distance)) # calling a density function on bmi
my_data[,.N, by = Intended]
my_data[,.N, by = Location]

my_data[,unique(Location)]
my_data[,unique(`Disengagement category`)]
my_data[,unique(`aiDrive version`)]
```

```{r}
# Having all the self driving sessions after the xth uninteded disengagement
x = 50
data <- my_data[Start >= my_data[Intended == 'FALSE', Start][x]]
y <- nrow(data)

# sum of kms driven globally
data[,sum(Distance)]
# sum of kms driven per location
data[,sum(Distance), by = Location]

# Avg kms driven per unintended diseng globally
data[,sum(Distance)]/y

# Avg kms driven per unintended diseng locally
countries <- data[,list(self_driving_session = .N, sum_kms_driven = sum(Distance)), by = Location]
countries[, avg_kms_druven := sum_kms_driven/self_driving_session]
countries
```

```{r}
my_data[,.N, by = list(`Disengagement category`, Location)]
#table(data$`Disengagement category`)
my_data[Location == 'Hungary', .N, by = list(`Disengagement category`, Location)]
ggplot(data, aes(`Disengagement category`)) + geom_bar() + facet_wrap(~Location)
ggplot(data, aes(`Disengagement category`)) + geom_bar() + facet_wrap(~`aiDrive version`)
```

```{r}
# Filtering
Sys.time()
Sys.Date()
basis_date <- Sys.Date()
#data <- data[Start > ]
```